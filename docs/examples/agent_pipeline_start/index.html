<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/agent_pipeline_start" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Comprehensive Guide: Using the Agentic Part of ROLL | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://momo-oi.github.io/ROLL/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://momo-oi.github.io/ROLL/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://momo-oi.github.io/ROLL/docs/examples/agent_pipeline_start"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comprehensive Guide: Using the Agentic Part of ROLL | My Site"><meta data-rh="true" name="description" content="Table of Contents"><meta data-rh="true" property="og:description" content="Table of Contents"><link data-rh="true" rel="icon" href="/ROLL/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://momo-oi.github.io/ROLL/docs/examples/agent_pipeline_start"><link data-rh="true" rel="alternate" href="https://momo-oi.github.io/ROLL/docs/examples/agent_pipeline_start" hreflang="en"><link data-rh="true" rel="alternate" href="https://momo-oi.github.io/ROLL/docs/examples/agent_pipeline_start" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Comprehensive Guide: Using the Agentic Part of ROLL","item":"https://momo-oi.github.io/ROLL/docs/examples/agent_pipeline_start"}]}</script><link rel="alternate" type="application/rss+xml" href="/ROLL/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ROLL/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/ROLL/assets/css/styles.f7cb7648.css">
<script src="/ROLL/assets/js/runtime~main.e8b27f47.js" defer="defer"></script>
<script src="/ROLL/assets/js/main.b09c0023.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ROLL/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ROLL/"><div class="navbar__logo"><img src="/ROLL/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ROLL/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ROLL/docs/examples/agent_pipeline_start">Tutorial</a><a class="navbar__item navbar__link" href="/ROLL/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/ROLL/docs/examples/agent_pipeline_start">examples</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ROLL/docs/examples/agent_pipeline_start">Comprehensive Guide: Using the Agentic Part of ROLL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROLL/docs/examples/config_guide">Configuration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROLL/docs/examples/rlvr_pipeline_start">RLVR Pipeline</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ROLL/docs/">ROLL</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ROLL/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">examples</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Comprehensive Guide: Using the Agentic Part of ROLL</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comprehensive Guide: Using the Agentic Part of ROLL</h1></header>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#core-components">Core Components</a></li>
<li><a href="#running-the-agentic-pipeline">Running the Agentic Pipeline</a></li>
<li><a href="#step-by-step-example">Step-by-Step Example</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#further-information">Further Information</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The ROLL (Reinforcement Learning Optimization for Large-Scale Learning) agentic pipeline empowers you to:</p>
<ul>
<li>Define, configure, and simulate interactions between AI agents (often Large Language Models) and diverse environments.</li>
<li>Train these agents using reinforcement learning algorithms like Proximal Policy Optimization (PPO), GRPO, and <strong>reinforce++</strong>.</li>
<li>Evaluate agent performance on specific tasks and complex reasoning scenarios.</li>
<li>Leverage <a href="https://www.ray.io/" target="_blank" rel="noopener noreferrer">Ray</a> for efficient, distributed computation across large-scale GPU setups.</li>
</ul>
<p>This guide provides a step-by-step walkthrough for utilizing these agentic capabilities.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>This tutorial guides you through setting up, configuring, and running the agentic components of the ROLL library. The agentic part of ROLL is specifically designed for building and training AI agents that learn through interaction. This is crucial for tasks like aligning LLMs with human preferences, teaching them complex reasoning, or improving their performance in multi-turn interaction scenarios.</p>
<p>We will cover the general workflow, which you can adapt for various environments and agent configurations based on your specific research or application needs.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>Before you begin, ensure you have the following:</p>
<ol>
<li>
<p><strong>ROLL Project Installed</strong> – The ROLL project should be cloned and properly set up. Please refer to the main <code>README.md</code> in the project root for detailed installation instructions. Key requirements often include:</p>
<ul>
<li>CUDA Version &gt;= 12.4</li>
<li>cuDNN Version &gt;= 9.1.0</li>
<li>PyTorch &gt;= 2.5.1</li>
<li>vLLM &gt;= 0.7.3</li>
<li>SGlang &gt;= 0.4.3<br>
<!-- -->ROLL also provides Docker images for a quick start.</li>
</ul>
</li>
<li>
<p><strong>Python Dependencies</strong> – Install all necessary Python dependencies, typically via the requirements file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install -r requirements.txt   # Or a specific file like requirements_torch260.txt</span><br></span></code></pre></div></div>
<p>Ensure any specific dependencies for your chosen agentic environments or models are also met.</p>
</li>
<li>
<p><strong>Python Environment</strong> – A working Python environment (python=3.10, or use our docker_images).</p>
</li>
<li>
<p><strong>Ray Setup (Recommended for Distributed Execution)</strong></p>
<ul>
<li>
<p>Install Ray:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install ray</span><br></span></code></pre></div></div>
</li>
<li>
<p>The project may contain example scripts for starting a Ray cluster, such as <code>examples/scripts/start_ray_cluster.sh</code>.</p>
</li>
</ul>
</li>
<li>
<p><strong>Environment Variables</strong> – Some scripts might require specific environment variables (e.g., <code>PYTHONPATH</code>). The provided execution scripts (like those in <code>examples</code>) often handle setting these.</p>
</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-components">Core Components<a href="#core-components" class="hash-link" aria-label="Direct link to Core Components" title="Direct link to Core Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agentic-pipeline-agenticpipeline">Agentic Pipeline (<code>AgenticPipeline</code>)<a href="#agentic-pipeline-agenticpipeline" class="hash-link" aria-label="Direct link to agentic-pipeline-agenticpipeline" title="Direct link to agentic-pipeline-agenticpipeline">​</a></h3>
<p>The main orchestrator for the agentic RL process. It manages the entire workflow, including:</p>
<ul>
<li>Initializing and managing distributed workers (actors, critics, environment managers).</li>
<li>Coordinating data collection (rollouts) where the agent interacts with the environment.</li>
<li>Executing model training steps (e.g., PPO updates for actor and critic).</li>
<li>Handling model synchronization and checkpointing.</li>
<li>Running evaluation loops.</li>
<li>Logging metrics and experiment tracking.</li>
</ul>
<p><strong>Source Code</strong>: <code>roll/pipeline/agentic/agentic_pipeline.py</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agentic-configuration-agenticconfig">Agentic Configuration (<code>AgenticConfig</code>)<a href="#agentic-configuration-agenticconfig" class="hash-link" aria-label="Direct link to agentic-configuration-agenticconfig" title="Direct link to agentic-configuration-agenticconfig">​</a></h3>
<p>The <code>AgenticConfig</code> (defined in <code>roll/pipeline/agentic/agentic_config.py</code>) is a Pydantic/dataclass-based configuration object that specifies all parameters for an agentic pipeline run. It is typically defined and populated from a YAML file using Hydra.</p>
<p><strong>Role</strong>: Holds settings for environments, agent models (actor, critic, reference), reward mechanisms, training algorithms (e.g., PPO hyperparameters), rollout procedures, logging, and distributed execution strategies.</p>
<p><strong>Key Nested Configurations</strong></p>
<ul>
<li><code>actor_train</code>, <code>actor_infer</code>, <code>critic</code>, <code>reference</code> – Instances of <code>WorkerConfig</code> defining the models, hardware, and strategies for each role.</li>
<li><code>train_env_manager</code>, <code>val_env_manager</code> – Instances of <code>EnvManagerConfig</code> specifying how environments are instantiated and managed for training and validation rollouts.</li>
<li><code>reward_normalization</code> – Configuration for normalizing rewards.</li>
</ul>
<p><strong>Example Configurations</strong> – See example YAML files in directories like <code>examples/qwen2.5-0.5B-agentic_ds</code> (e.g., <code>agent_val_frozen_lake.yaml</code>). These YAMLs use Hydra to set the fields within <code>AgenticConfig</code>.</p>
<p><strong>Key parameters often set via YAML for <code>AgenticConfig</code> include</strong></p>
<ul>
<li><code>exp_name</code>, <code>seed</code>, <code>logging_dir</code>, <code>output_dir</code> – General experiment settings.</li>
<li><code>max_steps</code>, <code>save_steps</code>, <code>logging_steps</code>, <code>eval_steps</code> – Pipeline control for duration and frequencies.</li>
<li><code>pretrain</code>, <code>reward_pretrain</code> – Paths to base models for actor/reference and critic respectively.</li>
<li><code>ppo_epochs</code>, <code>init_kl_coef</code>, <code>adv_estimator</code>, <code>gamma</code>, <code>lambd</code> – PPO and RL algorithm parameters.</li>
<li><code>custom_envs</code> – A dictionary defining custom environments available to the pipeline, including their type, instructions, and specific configurations.</li>
<li><code>train_env_manager</code> / <code>val_env_manager</code> settings:<!-- -->
<ul>
<li><code>env_groups</code>, <code>group_size</code> – For managing parallel environments.</li>
<li><code>tags</code>, <code>n_groups</code> – To select and apportion environments from <code>custom_envs</code>.</li>
</ul>
</li>
<li>Worker-specific settings under <code>actor_train</code>, <code>actor_infer</code>, etc.:<!-- -->
<ul>
<li><code>model_args</code> – Model architecture, dtype (e.g., bf16), attention type (e.g., flash_attn).</li>
<li><code>training_args</code> – Learning rate, batch size, gradient accumulation.</li>
<li><code>generating_args</code> – <code>max_new_tokens</code>, <code>top_p</code>, <code>temperature</code> for inference.</li>
<li><code>strategy_args</code> – Distributed strategy (e.g., <code>deepspeed_train</code>, <code>vllm</code>, <code>sglang</code>, <code>hf_infer</code>) and its specific configuration.</li>
<li><code>device_mapping</code> – GPU allocation for the worker.</li>
</ul>
</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environments-baseenv-and-implementations">Environments (<code>BaseEnv</code> and implementations)<a href="#environments-baseenv-and-implementations" class="hash-link" aria-label="Direct link to environments-baseenv-and-implementations" title="Direct link to environments-baseenv-and-implementations">​</a></h3>
<p>ROLL supports various environments for agent training, typically located in subdirectories under <code>roll/agentic/env/</code>.</p>
<ul>
<li><strong>Base Class</strong> – <code>roll/agentic/env/base.py</code> defines the interface for all environments, including methods like <code>reset</code> and <code>step</code>.</li>
<li><strong>Examples</strong> – <code>FrozenLakeEnv</code>, <code>SokobanEnv</code>. Specific configuration (e.g., map size, game rules) is defined within the <code>custom_envs</code> section of the main YAML config.</li>
<li>Each environment type might also have its own specific config dataclass (e.g., <code>roll/agentic/env/frozen_lake/config.py</code>) that is instantiated based on the YAML.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="models--workers">Models &amp; Workers<a href="#models--workers" class="hash-link" aria-label="Direct link to Models &amp; Workers" title="Direct link to Models &amp; Workers">​</a></h3>
<p>The agentic pipeline typically involves multiple model roles, managed by dedicated workers:</p>
<ul>
<li><strong>Actor Model (<code>ActorWorker</code>)</strong> – The policy that generates actions based on observations. It&#x27;s trained to maximize expected rewards.</li>
<li><strong>Critic Model (<code>CriticWorker</code>)</strong> – Estimates the value function (e.g., expected return from a state). Used in algorithms like PPO with GAE to reduce variance and guide actor training.</li>
<li><strong>Reference Model (<code>ActorWorker</code>)</strong> – Often a snapshot of the initial policy or a fixed reference policy, used for calculating KL divergence to regularize policy updates.</li>
<li><strong>Environment Manager (<code>EnvironmentWorker</code>, managed by <code>RolloutScheduler</code>)</strong> – Handles stepping through multiple environment instances in parallel, collecting trajectories.</li>
</ul>
<p>Model paths, types, and distributed strategies are specified in their respective worker configuration blocks within the main YAML (e.g., <code>actor_train</code>, <code>critic</code>).</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-agentic-pipeline">Running the Agentic Pipeline<a href="#running-the-agentic-pipeline" class="hash-link" aria-label="Direct link to Running the Agentic Pipeline" title="Direct link to Running the Agentic Pipeline">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="method1-using-the-python-launcher-script-with-hydra-recommended">Method 1: Using the Python Launcher Script with Hydra (Recommended)<a href="#method1-using-the-python-launcher-script-with-hydra-recommended" class="hash-link" aria-label="Direct link to Method 1: Using the Python Launcher Script with Hydra (Recommended)" title="Direct link to Method 1: Using the Python Launcher Script with Hydra (Recommended)">​</a></h3>
<p>The primary method is to use the <code>examples/start_agentic_pipeline.py</code> script. This script uses Hydra to load and manage configurations.</p>
<ol>
<li>
<p><strong>Choose or Create a Configuration File</strong><br>
<!-- -->Start with an example YAML (e.g., <code>examples/qwen2.5-0.5B-agentic_ds/agent_val_frozen_lake.yaml</code>) or create your own.</p>
</li>
<li>
<p><strong>Execute the Python Launcher Script</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Ensure you are in the root of the ROLL project directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># export PYTHONPATH=$(pwd):$PYTHONPATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python examples/start_agentic_pipeline.py \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-path examples/qwen2.5-0.5B-agentic_ds \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-name agent_val_frozen_lake</span><br></span></code></pre></div></div>
<ul>
<li><code>--config-path</code> – Directory containing your YAML configuration.</li>
<li><code>--config-name</code> – Filename (without <code>.yaml</code>).</li>
<li>You can add Hydra overrides, e.g. <code>exp_name=my_new_experiment seed=123</code>.</li>
</ul>
</li>
</ol>
<p>The <code>start_agentic_pipeline.py</code> script:</p>
<ul>
<li>Initializes Hydra.</li>
<li>Composes the configuration.</li>
<li>Converts the OmegaConf object into an <code>AgenticConfig</code> dataclass instance.</li>
<li>Initializes Ray.</li>
<li>Instantiates the <code>AgenticPipeline</code> and calls <code>run()</code>.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="method2-using-helper-shell-scripts">Method 2: Using Helper Shell Scripts<a href="#method2-using-helper-shell-scripts" class="hash-link" aria-label="Direct link to Method 2: Using Helper Shell Scripts" title="Direct link to Method 2: Using Helper Shell Scripts">​</a></h3>
<p>The <code>examples</code> directory often contains shell scripts wrapping the Python launcher (e.g., <code>run_agentic_pipeline_frozen_lake.sh</code>).</p>
<p>Example structure:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example: examples/qwen2.5-0.5B-agentic_ds/run_agentic_pipeline_frozen_lake.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG_NAME=&quot;agent_val_frozen_lake&quot;                         # agent_val_frozen_lake.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG_PATH_DIR=&quot;examples/qwen2.5-0.5B-agentic_ds&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SCRIPT_DIR=$(dirname &quot;$(realpath &quot;$0&quot;)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROJECT_ROOT=$(dirname &quot;$(dirname &quot;$SCRIPT_DIR&quot;)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PYTHONPATH=$PROJECT_ROOT:$PYTHONPATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export RAY_LOG_WITHOUT_ANSI_CODES=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;PYTHONPATH: $PYTHONPATH&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Using Hydra config directory: $CONFIG_PATH_DIR and config name: $CONFIG_NAME&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python $PROJECT_ROOT/examples/start_agentic_pipeline.py \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-path $CONFIG_PATH_DIR \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-name $CONFIG_NAME \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;$@&quot;   # Pass through any extra args</span><br></span></code></pre></div></div>
<p>Run it with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bash examples/qwen2.5-0.5B-agentic_ds/run_agentic_pipeline_frozen_lake.sh</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-example">Step-by-Step Example<a href="#step-by-step-example" class="hash-link" aria-label="Direct link to Step-by-Step Example" title="Direct link to Step-by-Step Example">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step1-locate-and-review-configuration">Step 1: Locate and Review Configuration<a href="#step1-locate-and-review-configuration" class="hash-link" aria-label="Direct link to Step 1: Locate and Review Configuration" title="Direct link to Step 1: Locate and Review Configuration">​</a></h3>
<ul>
<li>File: <code>examples/qwen2.5-0.5B-agentic_ds/agent_val_frozen_lake.yaml</code><br>
<!-- -->Key sections include <code>exp_name</code>, <code>seed</code>, <code>output_dir</code>, model paths, <code>actor_train</code>, <code>actor_infer</code>, <code>reference</code>, PPO parameters, and <code>custom_envs</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step2-prepare-the-environment-and-dependencies">Step 2: Prepare the Environment and Dependencies<a href="#step2-prepare-the-environment-and-dependencies" class="hash-link" aria-label="Direct link to Step 2: Prepare the Environment and Dependencies" title="Direct link to Step 2: Prepare the Environment and Dependencies">​</a></h3>
<ul>
<li>
<p>Ensure <code>gymnasium</code> (or the relevant env dependency) is installed:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install gymnasium</span><br></span></code></pre></div></div>
</li>
<li>
<p>Verify all model paths in the YAML are accessible.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step3-launch-the-pipeline">Step 3: Launch the Pipeline<a href="#step3-launch-the-pipeline" class="hash-link" aria-label="Direct link to Step 3: Launch the Pipeline" title="Direct link to Step 3: Launch the Pipeline">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python examples/start_agentic_pipeline.py \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-path examples/qwen2.5-0.5B-agentic_ds \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --config-name agent_val_frozen_lake</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step4-monitoring">Step 4: Monitoring<a href="#step4-monitoring" class="hash-link" aria-label="Direct link to Step 4: Monitoring" title="Direct link to Step 4: Monitoring">​</a></h3>
<ul>
<li>
<p><strong>Console Output</strong> – Observe Hydra, Ray, and pipeline logs.</p>
</li>
<li>
<p><strong>Log Files</strong> – Check the <code>logging_dir</code> specified in YAML.</p>
</li>
<li>
<p><strong>Experiment Tracking</strong> – If configured, metrics appear in WandB.</p>
</li>
<li>
<p><strong>TensorBoard</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tensorboard --logdir &lt;your_log_dir&gt;</span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step5-outputs-and-results">Step 5: Outputs and Results<a href="#step5-outputs-and-results" class="hash-link" aria-label="Direct link to Step 5: Outputs and Results" title="Direct link to Step 5: Outputs and Results">​</a></h3>
<ul>
<li><strong>Trained Models</strong> – Checkpoints saved under <code>output_dir</code>.</li>
<li><strong>Evaluation Metrics</strong> – Logged in WandB/TensorBoard and console.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<ul>
<li><strong>Import Errors</strong> – Ensure <code>PYTHONPATH</code> includes the ROLL project root.</li>
<li><strong>Configuration Errors</strong>
<ul>
<li>YAML syntax – lint your YAML.</li>
<li>Hydra path/name – verify <code>--config-path</code> and <code>--config-name</code>.</li>
<li>Pydantic validation – check <code>roll/pipeline/agentic/agentic_config.py</code> field definitions.</li>
</ul>
</li>
<li><strong>Model Loading Issues</strong> – Confirm paths, model types, and strategies (vLLM, SGLang, DeepSpeed, Megatron-Core).</li>
<li><strong>CUDA/GPU Issues</strong> – Adjust <code>CUDA_VISIBLE_DEVICES</code>, batch sizes, or <code>gpu_memory_utilization</code>.</li>
<li><strong>Ray Issues</strong> – Ensure Ray is started and resource requests match hardware.</li>
<li><strong>Environment Registration</strong> – Verify <code>env_type</code> values correspond to registered env classes.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-information">Further Information<a href="#further-information" class="hash-link" aria-label="Direct link to Further Information" title="Direct link to Further Information">​</a></h2>
<ul>
<li>Full configuration definitions: <code>roll/pipeline/agentic/agentic_config.py</code> and related dataclasses.</li>
<li>Environment implementations: <code>roll/agentic/env/</code> (e.g., <code>frozen_lake/env.py</code>).</li>
<li>Core pipeline logic: <code>roll/pipeline/agentic/agentic_pipeline.py</code>.</li>
<li>The project <code>README.md</code> provides additional high-level details on features like GRPO, Reasoning Pipeline, and integrations with Ray, DeepSpeed, Megatron-Core, vLLM, and SGlang.</li>
</ul>
<hr>
<p><em>Happy experimenting!</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/examples/agent_pipeline_start.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/ROLL/docs/examples/config_guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Guide</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#core-components" class="table-of-contents__link toc-highlight">Core Components</a><ul><li><a href="#agentic-pipeline-agenticpipeline" class="table-of-contents__link toc-highlight">Agentic Pipeline (<code>AgenticPipeline</code>)</a></li><li><a href="#agentic-configuration-agenticconfig" class="table-of-contents__link toc-highlight">Agentic Configuration (<code>AgenticConfig</code>)</a></li><li><a href="#environments-baseenv-and-implementations" class="table-of-contents__link toc-highlight">Environments (<code>BaseEnv</code> and implementations)</a></li><li><a href="#models--workers" class="table-of-contents__link toc-highlight">Models &amp; Workers</a></li></ul></li><li><a href="#running-the-agentic-pipeline" class="table-of-contents__link toc-highlight">Running the Agentic Pipeline</a><ul><li><a href="#method1-using-the-python-launcher-script-with-hydra-recommended" class="table-of-contents__link toc-highlight">Method 1: Using the Python Launcher Script with Hydra (Recommended)</a></li><li><a href="#method2-using-helper-shell-scripts" class="table-of-contents__link toc-highlight">Method 2: Using Helper Shell Scripts</a></li></ul></li><li><a href="#step-by-step-example" class="table-of-contents__link toc-highlight">Step-by-Step Example</a><ul><li><a href="#step1-locate-and-review-configuration" class="table-of-contents__link toc-highlight">Step 1: Locate and Review Configuration</a></li><li><a href="#step2-prepare-the-environment-and-dependencies" class="table-of-contents__link toc-highlight">Step 2: Prepare the Environment and Dependencies</a></li><li><a href="#step3-launch-the-pipeline" class="table-of-contents__link toc-highlight">Step 3: Launch the Pipeline</a></li><li><a href="#step4-monitoring" class="table-of-contents__link toc-highlight">Step 4: Monitoring</a></li><li><a href="#step5-outputs-and-results" class="table-of-contents__link toc-highlight">Step 5: Outputs and Results</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#further-information" class="table-of-contents__link toc-highlight">Further Information</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ROLL/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ROLL/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>